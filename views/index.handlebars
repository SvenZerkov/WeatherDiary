{{> header}}

<div class="container">


  <h1>Weather Diary</h1>

  {{#if desc}}
  <p>{{desc}}</p>
  {{else}}
  <p>No content</p>
  {{/if}}

  <body>


    <div class="row">
      <div class="col-sm-6">
        <h2>Weather history DATE</h2>
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>Date</th>
              <th>Temperature</th>
              <th>Comments</th>
            </tr>

          </thead>
          <tbody>
            {{#each UserNotes}}

            <tr>
              <td>{{this.date}}</td>
              <td>{{this.temperature}}</td>
              <td>{{this.comment}}</td>
            </tr>
            {{/each}}

          </tbody>
        </table>
      </div>

      <div class="col-sm-6">
        <h2>Personal entries DATE</h2>
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>Temperature</th>
              <th>Comments</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>4.8 &#8451;</td>
              <td>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et
                dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
                ex
                ea commodo consequat.</td>
              <td><input type="button" class="btn btn-primary" value="Update"><br><br>
                <input type="button" class="btn btn-danger" aria-label="Delete current note" id="deleteNoteButton"
                  value="Delete">
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="col-sm-4"></div>
    <div class="col-sm-12 personaldiaryentry">
      <h3>Personal diary entries</h3>

      <form action="/api/notes/" method="post">
        <table class="table table-bordered">
          <thead>
            <tr>
              <th><label for="date">Date</label></th>
              <th><label for="temperature">Temperature</label></th>
              <th><label for="comment">Comments</label></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><input type="date" id="date" name="date"></td>
              <td><input type="number" id="temperature" name="temperature" value="4.8 &#8451;"></td>
              <td><input type="text" id="comment" name="comment" value="">
              </td>
            </tr>
          </tbody>
        </table>
        <input type="submit" value="Submit">
      </form>
    </div>


    <div id="confirm-delete" class="modal">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title">Confirm deletion</h4>
            <button type="button" class="close" data-dismiss="modal">&times;</button>
          </div>
          <div class="modal-body">
            <p class="message"></p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-danger yes-delete">Yes</button>
            <button type="button" class="btn btn-default no-delete" data-dismiss="modal">No</button>
          </div>
        </div>
      </div>
    </div>


  </body>
  {{!-- script for event listener on deleteButton --}}


  <script>
    if (typeof jQuery == 'undefined') {
      console.log('jQuery is not loaded');
    } else {
      console.log('jQuery is loaded');
    };

    const deleteConfirm = (msg) => {
      return new Promise((resolve, reject) => {
        const confirmBox = $("#confirm-delete");
        confirmBox.find(".message").text(msg);
        confirmBox.find(".yes-delete").click(() => {
          confirmBox.hide();
          resolve();
        });
        confirmBox.find(".no-delete").click(() => {
          confirmBox.hide();
          reject();
        });
        confirmBox.show();
      });
    };


    const deleteNote = () => { // this func handles the deletion request
      console.log("Note deleted.");
      // send req to server to handle the delete
    };

    const deleteButton = document.getElementById("deleteNoteButton");

    deleteButton.addEventListener("click", () => {
      const confirmation = deleteConfirm("Do you want to delete the current note?");
      deleteConfirm("Do you want to delete the current note?").then(() => {
        deleteNote();
        // send req to server to handle the delete
      }).catch(() => {
        console.log("Deletion canceled.");
      });
    });
    /*
        deleteButton.addEventListener("click", function () {
          console.log("Delete button clicked");
        }); */




  </script>
</div>